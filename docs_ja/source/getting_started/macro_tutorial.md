(macro-tutorial)=

# マクロで独自機能を作成

このチュートリアルでは、マクロ機能を使用して複数の操作を組み合わせた独自機能を作成する方法を学びます。繰り返し作業の自動化や、複雑なワークフローの簡素化が可能になります。

## 学習内容

- マクロオペレーターエディターの基本操作
- 複数操作の記録と再生
- マクロのカスタマイズとパラメーター設定
- パイメニューとの連携

## マクロ「Quick Modeling Setup」を作成してみる

![Quick Modeling Setup](../images/macro_tutorial/modeling_setup.png)

今回は、モデリング作業でよく行う一連の設定を自動化するマクロを作成してみます。

### 1. マクロオペレーターの作成

まず、新しいマクロオペレーターを作成しましょう。

1. **PME > Editor** を開きます
2. 左上のドロップダウンから「**Macro Operator**」を選択
3. 新規マクロを作成し、名前を「**Quick Modeling Setup**」に設定

### 2. 操作の記録

モデリング準備に必要な操作を記録していきます。

1. **Record** ボタンを押して記録開始
2. 以下の操作を順番に実行：
   - オブジェクトをエディットモードに切り替え
   - ワイヤーフレーム表示を有効
   - X-Ray表示を有効
   - 面の向き表示を有効
3. **Stop** ボタンで記録終了

### 3. マクロの調整

記録された操作を確認し、必要に応じて調整します。

1. 記録された各ステップを確認
2. 不要な操作を削除
3. パラメーターを調整（必要な場合）
4. 操作順序を最適化

> **参照：** {ref}`macro-operator-editor` - マクロオペレーターエディターの詳細

### 4. パイメニューへの追加

作成したマクロをパイメニューに追加します。

1. 既存のパイメニュー（または新規作成）を開きます
2. 新しいアイテムを追加
3. **Command** を「**PME Macro**」に設定
4. 作成した「Quick Modeling Setup」マクロを選択
5. 適切なアイコンとラベルを設定

### 5. 動作確認と改良

1. パイメニューからマクロを実行してテスト
2. 期待通りの動作を確認
3. 必要に応じてマクロを修正・改良

---

## 応用例

### レンダリング準備マクロ

レンダリング前の一連の設定（ライト調整、材質最終化、レンダー設定など）を自動化。

### アニメーション作業マクロ

キーフレーム設定、ドープシート表示、再生設定などをワンクリックで実行。

### 書き出し準備マクロ

他のソフトウェアへの書き出し前に必要な設定変更を自動化。

---

## マクロ作成のコツ

### 1. 小さく始める
最初は簡単な2-3操作の組み合わせから始めて、徐々に複雑なマクロを作成しましょう。

### 2. テストを重ねる
様々なシーンや状況でマクロを実行して、予期しない動作がないか確認しましょう。

### 3. 命名規則を統一
マクロが増えてきたら、分かりやすい命名規則を決めて管理しましょう。

---

## まとめ

マクロ機能を活用することで、繰り返し作業の大幅な効率化が可能になります。作業パターンを分析して、適切なマクロを作成することで、創作活動により集中できる環境を構築できます。

---

## 次のステップ

- {ref}`macro-operator-editor` - マクロオペレーターエディターの詳細
- {ref}`scripting` - Python スクリプトによる高度なカスタマイズ
- {ref}`examples` - 実用的なマクロ例集